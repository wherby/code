
## 问题的本质
Bellman-ford 是可以求解有负边的图的距离最小值。
每一次距离求解 f(b) = f(a) + dis(a->b) 其实也是在距离上求解了 f(b) = min(f(b), f(a)+ dis(a->b)) , 这里是 关系是 f(b) >f(a) + dis(a->b) , 反之也成立

不等式约束的本质是什么 这里建立 小于关系不等式，则在松弛的时候要用max
本质是差分约束，从各个点的差分变成 < 的关系式子，然后通过V-1 轮次松弛希望得到差分约束系统的可行解，
使得方程组关于 < 的关系都成立。

## 
1. Bellman-Ford 算法与负权环的关系负权环 (Negative Cycle) 的影响在最短路径问题中：
   
        如果图中存在一个负权环，并且这个环可以从源点到达，那么最短路径将不存在。
        原因：你可以沿着这个环无限循环，每循环一次，路径的总权重就会减小一个负值。最短路径的长度将趋近于 $-\infty$。

Bellman-Ford 如何检测负权环

Bellman-Ford 算法利用了最短路径的一个基本性质：在一个没有负权环的图中，任意一条最短路径最多包含 $V-1$ 条边（其中 $V$ 是节点数）。

        第一阶段：$V-1$ 次松弛算法对图中的所有边重复执行松弛操作 $V-1$ 次。如果图中没有负权环，到此为止，所有节点的最短路径距离估计值 $D[v]$ 保证收敛到真实的最短路径距离。
        第二阶段：第 $V$ 次检查在完成 $V-1$ 次迭代后，算法再对所有边进行第 $V$ 次松弛操作（只检查，不继续迭代）。判定规则： 如果在第 $V$ 次松弛中，任何一条边 $(u, v)$ 仍然可以被松弛（即 $D[u] + w(u, v) < D[v]$），则证明图中有从源点可达的负权环。原因： 如果距离仍在减小，说明存在一条包含 $V$ 条或更多边的路径比已找到的路径更短，这只能通过无限次绕负权环实现。

|情况|   V 次检查时能否松弛|结论|
| :------- | :------: | -------: |
|无负权环|不能（所有距离已收敛）|找到最短路径|
|有负权环|能（距离继续减小）|存在负权环  |


2. Bellman-Ford 算法与正权环的关系

正权环 (Positive Cycle) 的影响

在最短路径问题中：
    
    正权环不会引起最短路径问题。如果进入一个正权环，总路径长度只会增加，因此最短路径一定不会包含正权环。
    Bellman-Ford 算法在处理正权图时仍然有效，但效率不如 Dijkstra 算法。
    
Bellman-Ford 与最长路径问题
然而，正权环与 Bellman-Ford 算法的变体——用于求解最长路径问题时——关系密切。

    最长路径问题：寻找从源点到目标点的最长简单路径。
    等价转换：最长路径问题可以通过将所有边的权重取反，转化为最短路径问题，然后使用 Bellman-Ford 算法。
    此时的负权环 $\to$ 原图的正权环：如果原图存在一个正权环（路径总权重 $> 0$），在权重取反后，它就变成了负权环。
    结论：在最长路径问题中，如果 Bellman-Ford 的变体（或最短路径算法应用于取反后的图）检测到负权环，则说明原图存在一个正权环，最长路径不存在（可以沿着正权环无限循环）。


3. 总结判定方法

|算法目标|环的类型|判定方法|
| :------- | :------: | -------: |
|最短路径|负权环|在 V−1 次松弛后，如果第 V 次松弛仍然成功，则存在负权环|
|最长路径|正权环|(1) 将所有边权取反。(2) 运行 Bellman-Ford 算法。(3) 如果检测到负权环，则原图存在正权环，最长路径不存在|