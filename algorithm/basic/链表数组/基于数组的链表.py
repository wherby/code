# è¿™æ®µä»£ç å®žçŽ°äº†ä¸€ä¸ªéžå¸¸é«˜æ•ˆçš„ã€åŸºäºŽæ•°ç»„çš„é“¾è¡¨ç»“æž„ï¼Œåœ¨ç®—æ³•ç«žèµ›ï¼ˆå°¤å…¶æ˜¯ Python é€‰æ‰‹ï¼‰ä¸­å¸¸è¢«ç”¨ä½œé‚»æŽ¥è¡¨çš„æžç®€æ›¿ä»£æ–¹æ¡ˆã€‚å®ƒé€šè¿‡ä¸¤ä¸ªæ•°ç»„æ¨¡æ‹Ÿäº†é“¾è¡¨çš„â€œæŒ‡é’ˆâ€è·³è½¬ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»º Python list å¯¹è±¡å¸¦æ¥çš„å†…å­˜å’Œæ—¶é—´å¼€é”€ã€‚

# ðŸ—ï¸ ç»“æž„æ·±åº¦è§£æž
# è¿™ä¸ªç±»çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šå°†æ‰€æœ‰æ’å…¥çš„å…ƒç´ æŒ‰é¡ºåºå­˜å…¥ä¸€ä¸ªå¤§æ•°ç»„ï¼Œå¹¶ç”¨å¦ä¸€ä¸ªæ•°ç»„è®°å½•â€œä¸Šä¸€ä¸ªå…ƒç´ â€çš„ä½ç½®ã€‚

# 1. æ ¸å¿ƒå±žæ€§
# self.lst: å­˜å‚¨æ¯ä¸ªâ€œæ¡¶â€ï¼ˆæˆ–é¡¶ç‚¹ï¼‰ä¸­æœ€åŽä¸€ä¸ªæ’å…¥å…ƒç´ åœ¨ self.cur ä¸­çš„ç´¢å¼•ã€‚åˆå§‹ä¸º -1ã€‚
# self.cur: é¡ºåºå­˜å‚¨æ‰€æœ‰è¢«æ·»åŠ çš„å€¼ï¼ˆå¯¹åº”é“¾è¡¨çš„ valueï¼‰ã€‚
# self.pre: å­˜å‚¨å½“å‰å…ƒç´ åœ¨ self.cur ä¸­çš„å‰é©±èŠ‚ç‚¹çš„ç´¢å¼•ï¼ˆå¯¹åº”é“¾è¡¨çš„ next æŒ‡é’ˆï¼‰ã€‚

#2. append(i, j) æ“ä½œï¼šå¤´æ’æ³•Pythondef append(self, i, j):
#     # 1. è®°å½• i å·æ¡¶å½“å‰æœ€é¡¶ç«¯çš„ç´¢å¼•ï¼Œä½œä¸ºæ–°å…ƒç´ çš„å‰é©±
#     self.pre.append(self.lst[i])
#     # 2. å°†æ–°å€¼ j å­˜å…¥ curï¼Œæ­¤æ—¶ç´¢å¼•æ˜¯ len(self.cur)
#     self.lst[i] = len(self.cur)
#     self.cur.append(j)
# è¿™å®žé™…ä¸Šæ˜¯åœ¨æ‰§è¡Œå¤´æ’æ³•ã€‚æ–°åŠ å…¥çš„å…ƒç´ ä¼šæˆä¸ºé“¾è¡¨çš„æ–°å¤´éƒ¨ï¼Œè€ŒåŽŸæœ‰çš„å¤´éƒ¨å˜æˆäº†æ–°å¤´éƒ¨çš„ preã€‚
# 3. iterate(i) æ“ä½œï¼šé€†åºéåŽ†Pythondef iterate(self, i):
#     tmp = self.lst[i] # æ‹¿åˆ°æœ€è¿‘æ’å…¥çš„ç´¢å¼•
#     while tmp != -1:
#         yield self.cur[tmp] # äº§å‡ºå€¼
#         tmp = self.pre[tmp] # æ ¹æ® pre æ•°ç»„å‘å‰è·³è½¬
# éåŽ†é¡ºåºä¸Žæ’å…¥é¡ºåºç›¸åï¼ˆåŽè¿›å…ˆå‡ºï¼ŒLIFOï¼‰ï¼Œç±»ä¼¼äºŽæ ˆçš„éåŽ†ã€‚ðŸš€ ä¸ºä»€ä¹ˆè¿™æ ·å†™ï¼Ÿï¼ˆæ€§èƒ½åˆ†æžï¼‰åœ¨å¤„ç†å¤§è§„æ¨¡å›¾è®ºé—®é¢˜ï¼ˆå¦‚ $N, M = 10^5$ï¼‰æ—¶ï¼ŒPython çš„ g = [[] for _ in range(n)] ä¼šäº§ç”Ÿå¤§é‡çš„å°å¯¹è±¡ã€‚
# åº”ç”¨åœºæ™¯å»ºè®®
# è¿™ä¸ªç»“æž„æœ€é€‚åˆä½œä¸ºé™æ€å›¾çš„å­˜å‚¨ï¼ˆé“¾å¼å‰å‘æ˜Ÿï¼‰ã€‚

# åœºæ™¯ï¼šå½“ä½ éœ€è¦å­˜å‚¨ä¸€ä¸ªç¨€ç–å›¾ï¼Œå¹¶ä¸”ä¸»è¦æ“ä½œæ˜¯éåŽ†æŸä¸ªé¡¶ç‚¹çš„æ‰€æœ‰è¾¹ã€‚

# ä¼˜åŠ¿ï¼šå®ƒå®Œå…¨æ¶ˆé™¤äº† list å¯¹è±¡å¤´å¸¦æ¥çš„é¢å¤–å†…å­˜æ¶ˆè€—ã€‚


class lst_lst:
    def __init__(self, n) -> None:
        self.n = n
        self.pre = []
        self.cur = []
        self.lst = [-1] * n
    
    def append(self, i, j):
        self.pre.append(self.lst[i])
        self.lst[i] = len(self.cur)
        self.cur.append(j)
    
    def iterate(self, i):
        tmp = self.lst[i]
        while tmp != -1:
            yield self.cur[tmp]
            tmp = self.pre[tmp]


ll = lst_lst(10)

ll.append(3,4)
print(ll.lst)
ll.append(3,6)
for a in ll.iterate(3):
    print(a)