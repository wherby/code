

霍尔婚配定理（Hall's Marriage Theorem）是组合数学中一个非常经典且迷人的定理。它最初的背景确实和“相亲/结婚”有关，但其数学本质是关于**二分图是否存在完美匹配（或覆盖匹配）**的充要条件。

---

### 1. 直观的背景故事

想象有  个男生和  个女生。每个男生都列出了他中意的女生名单（可能有多个）。
**问题是**：是否存在一种方案，让每个男生都能娶到一位他中意的女生，且每个女生只能嫁给一个人？

霍尔定理告诉我们，**当且仅当**满足以下条件时，匹配才存在：

> **对于男生集合中的任意  个男生，他们中意的女生人数之和（并集）必须大于等于 。**

**直观解释**：如果你选出 3 个男生，但他们 3 个人喜欢的女生一共只有 2 个，那无论如何分配，总会有一个男生落单。霍尔定理神就神在，它证明了只要这一个“数量不缩减”的条件满足，就一定能成功配对。

---

### 2. 数学表达

在二分图  中，令  为左侧顶点集（男生）， 为右侧顶点集（女生）。
对于  的任意子集 ，记  为  中所有顶点在  中的邻居并集。

**定理内容**：
 到  存在一个大小为  的匹配（即覆盖住  中所有点）的充要条件是：


---

### 3. 在区间问题中的应用（回到你的题目）

在你的考试座位分配问题中，霍尔定理被巧妙地转化了。

* **男生 **：就是那  个需要考试的学生。
* **女生 **：就是那  个考试位置。
* **中意名单**：第  天的学生只能去  范围内的位置。

由于这里的邻居关系是**连续的区间**，原本要检查“所有子集 ”的复杂性被大大简化了。数学上可以证明：**对于区间类的二分图，我们只需要检查连续的子集（即子区间）就足够了。**

这就是为什么你的算法只需要检查：

> **任意子区间  的学生总数  该区间能到达的所有位置的容量总和。**

---

### 4. 为什么你的 DP 代码和霍尔定理有关？

你代码里的 `diff` 和 `cur` 逻辑：



这就是在验证霍尔定理的条件：

* 左边：子区间内的“男生”数量。
* 右边：这些“男生”能对应到的“女生”并集数量。

---

### 5. 生活中的其他例子

* **任务调度**： 个任务有不同的截止日期，每台机器每个时段只能处理一个任务，判断是否能按时完成。
* **代表团问题**：有多个委员会，每个委员会要选出一名代表，且代表不能重复，判断能否选齐。
* **网络流量**：判断数据流是否能通过一系列带宽受限的节点。

### 总结

霍尔婚配定理是**“需求”与“容量”**之间的一场博弈。它告诉我们，局部的失败（某几个人的选择太少）会导致全局的崩溃；而只要局部都站得住脚，全局就一定有解。

**你想深入了解一下这个定理的证明过程（比如通过增广路径来证明），还是想看它在其他算法题（如矩阵覆盖）中的变体应用？**