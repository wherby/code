class Solution:
    def minimizeTheDifference(self, mat, target) :
        maxV =810
        dp =[]
        m = len(mat)
        n = len(mat[0])
        noV = -1000000
        for i in range(m+1):
            dp.append([noV]*maxV)
        validList=[0]
        for i in range(m):
            tpVList=[]
            dic ={}
            for j in range(n):
                t = mat[i][j]
                for t1 in validList:
                    t2 = t +t1
                    if t2 <maxV and t2 not in dic:
                        tpVList.append(t2)
                        dic[t2]=1
            validList =tpVList
            #print(validList,tpVList)
        minV = 10000000
        if len(validList) ==0:
            re =0
            for i in range(m):
                re += min(mat[i])
            return re - target
        for i in validList:
            t = abs(target - i)
            if t < minV:
                minV = t
        return minV
                    





mat = [[28,26,21,28,60,47,23,3,19,52,64,63,43,53,9,33,29,60,25,69,30,16,24,64,60,22,57,45,68,66,63,30,29,60,65,5,16,38,60,62,57,40,35,44,39,24,8,33,22,22,64,21],[44,60,47,35,47,39,48,23,40,1,48,2,50,30,36,10,53,34,8,6,35,12,33,28,69,13,14,1,69,18,17,11,45,10,30,10,20,68,67,54,41,42,41,54,66,45,13,31,10,31,50,39],[10,17,16,30,3,12,64,33,53,42,48,33,2,3,52,56,14,20,19,66,58,43,35,41,22,10,31,65,45,8,52,56,47,30,49,14,55,33,59,43,48,7,62,1,56,50,22,12,27,5,41,59],[35,21,64,53,42,61,1,46,9,45,66,33,36,54,27,18,50,65,65,6,39,56,8,17,11,7,42,39,24,14,17,56,29,48,16,12,7,19,69,23,6,23,2,46,18,7,11,13,22,36,54,4],[25,16,9,52,56,3,28,45,5,22,49,62,65,21,11,43,67,41,3,44,32,66,14,13,70,60,9,43,27,55,61,6,44,7,5,28,39,67,12,20,53,65,40,55,69,63,3,62,29,15,5,57],[10,55,58,47,17,63,54,59,62,6,69,4,62,69,58,33,7,5,57,19,32,36,6,18,46,18,23,43,59,54,30,42,57,8,13,34,54,26,6,65,48,32,10,3,70,58,55,17,14,40,69,49],[44,45,55,20,16,45,42,53,29,41,45,45,44,50,37,61,63,59,50,18,18,65,45,19,16,64,59,31,37,67,24,11,11,64,43,42,50,11,68,54,57,13,59,25,45,30,21,34,23,50,67,38],[39,41,26,18,21,68,33,2,64,16,43,39,17,61,10,62,50,7,63,50,28,36,11,19,14,30,67,22,64,41,3,69,56,1,52,12,47,4,59,28,28,63,16,11,63,4,27,61,28,24,47,70],[42,27,2,59,62,65,59,35,68,14,65,38,46,66,11,12,42,12,33,43,43,23,13,23,10,40,32,22,68,21,4,40,18,32,33,67,68,3,53,47,37,67,49,48,44,61,18,38,60,34,33,35],[44,11,39,62,28,68,21,69,56,61,34,36,26,6,44,1,10,38,37,9,28,28,18,35,40,61,53,11,6,52,20,69,59,19,31,39,54,48,24,5,41,36,42,39,29,70,41,67,28,34,45,26],[19,1,33,67,35,69,32,22,8,24,17,28,56,33,1,30,47,30,13,8,59,23,49,40,43,5,20,69,46,61,64,25,8,12,41,60,47,27,48,33,9,33,29,62,69,63,42,66,39,14,52,58],[47,70,20,14,60,24,68,66,12,1,42,47,52,50,20,19,28,48,60,33,29,60,22,69,53,37,59,66,4,25,9,46,22,5,19,55,34,22,7,43,8,36,5,10,11,51,6,26,34,58,64,43],[38,60,60,32,31,50,57,6,70,39,10,70,14,64,8,62,34,5,46,11,49,52,59,13,29,41,6,34,61,55,33,11,7,1,41,34,53,32,52,39,18,25,63,60,41,22,29,28,52,22,68,4],[42,3,6,69,24,66,32,47,49,67,54,67,17,70,50,40,22,61,6,39,48,57,56,46,2,62,65,27,37,64,34,17,44,45,41,43,62,58,15,3,59,39,37,61,58,50,38,47,44,57,3,29],[54,35,37,21,64,68,26,20,36,3,45,60,20,22,44,61,2,18,68,24,43,36,57,41,27,69,49,48,5,49,38,1,1,59,25,25,21,62,20,8,19,70,34,7,33,39,22,33,18,10,11,59],[1,14,38,36,22,18,2,44,54,11,6,6,34,37,7,5,24,46,58,22,43,4,43,66,58,31,67,46,52,11,14,45,6,58,56,57,60,62,51,38,59,16,67,61,49,61,34,55,41,50,26,25],[9,26,10,52,50,38,39,69,68,21,15,4,59,9,13,59,1,68,46,51,23,10,70,5,25,31,36,57,2,13,41,56,53,27,56,29,5,17,70,3,59,18,13,54,31,41,50,66,39,70,64,58],[38,20,56,16,21,10,64,19,11,67,35,54,37,68,40,56,50,36,48,36,67,49,58,19,43,46,51,26,5,41,38,50,22,16,69,70,34,26,40,20,35,66,48,63,11,1,35,21,18,61,52,36],[68,35,28,39,41,45,20,1,17,11,29,39,47,5,21,41,45,2,2,59,59,64,19,69,12,32,70,66,60,9,38,61,47,55,61,52,5,2,22,60,10,28,63,17,61,35,25,38,4,35,56,49],[23,65,28,65,25,16,1,21,50,23,9,44,26,2,23,50,29,33,28,64,11,47,39,35,24,37,16,20,11,35,30,19,68,64,68,54,27,19,54,10,43,5,65,34,7,18,45,47,44,62,8,1],[18,26,4,3,8,59,40,34,56,17,20,45,43,47,38,31,61,32,6,44,22,33,70,2,22,54,1,12,27,11,34,1,5,24,69,28,43,2,54,6,5,45,3,14,45,47,54,58,54,24,70,69],[46,45,53,14,34,37,46,57,19,69,14,52,55,16,56,35,24,5,53,12,20,9,20,5,58,57,16,22,18,8,30,33,34,7,44,9,25,21,26,21,65,64,1,26,26,46,55,27,18,46,50,17],[54,17,58,62,57,69,61,2,20,35,17,26,37,11,41,15,26,27,12,68,24,33,17,46,13,2,30,31,59,33,32,20,58,67,33,54,59,16,49,11,4,69,4,7,13,11,45,9,44,70,38,42],[25,17,37,40,69,51,44,8,13,32,33,36,53,58,49,24,13,33,20,62,59,66,9,18,40,11,41,64,29,2,28,12,45,54,29,61,24,4,63,25,59,69,27,39,52,6,43,43,32,17,27,22],[45,32,49,3,49,36,17,64,68,21,66,10,32,24,31,23,25,22,41,43,41,2,47,17,35,28,40,46,21,41,2,69,66,45,64,31,28,26,17,6,22,19,57,15,12,9,49,26,16,54,42,58],[68,52,33,3,3,43,30,12,10,69,53,56,19,57,10,43,51,55,9,60,65,67,31,66,22,69,6,17,45,30,16,52,62,39,7,65,42,41,60,65,18,46,54,59,8,48,7,12,51,37,32,63],[26,51,16,21,32,18,8,19,27,58,16,37,15,13,34,17,12,11,58,19,66,51,33,45,22,2,15,21,39,64,19,61,56,59,50,33,18,25,25,50,26,44,66,60,3,14,69,37,59,65,47,49],[37,50,14,43,65,47,31,65,21,64,37,69,15,55,20,28,6,1,62,58,58,68,37,26,39,17,23,46,59,11,24,46,1,1,45,57,33,43,66,31,17,43,44,35,40,21,19,41,40,55,69,9],[34,9,59,35,59,32,2,24,31,61,57,20,40,17,35,13,52,7,46,16,9,44,21,35,39,64,22,16,44,30,55,27,48,14,49,58,23,57,39,25,47,2,38,36,52,18,49,32,48,29,50,32],[5,21,42,18,30,34,55,59,64,14,8,67,13,41,69,62,48,7,26,30,58,38,2,38,16,5,10,44,7,52,50,29,15,1,60,31,63,61,37,9,67,24,53,58,60,56,35,9,20,10,45,46],[54,41,12,22,22,56,49,18,67,11,50,46,24,22,64,13,1,25,53,31,51,18,38,3,36,31,52,46,28,5,36,62,13,53,57,36,13,8,19,46,14,11,10,65,27,37,15,68,8,60,65,4],[3,16,2,67,14,6,9,69,67,5,4,5,56,26,38,56,60,22,31,2,30,23,26,36,42,35,6,2,37,5,68,16,12,7,29,55,54,61,69,3,21,3,41,26,39,22,67,12,68,14,43,6],[11,34,23,38,36,48,3,51,50,51,56,34,17,21,48,7,31,36,20,42,63,32,24,9,21,66,26,20,26,34,1,33,5,27,48,40,26,57,68,10,8,16,23,35,44,67,60,10,42,49,63,58],[7,25,19,41,13,14,11,20,45,15,42,63,43,43,59,53,27,26,45,44,24,44,57,14,8,53,28,8,42,35,18,45,17,47,8,61,37,66,40,46,32,50,52,48,11,11,70,42,22,10,57,56],[56,3,57,28,6,43,38,37,66,60,10,48,38,26,60,1,38,4,8,41,49,66,25,31,27,22,64,7,31,25,51,18,57,55,65,12,28,45,9,54,36,27,20,63,49,36,62,22,2,1,41,44],[35,32,47,27,25,14,22,21,55,34,31,66,63,60,16,7,6,51,69,32,69,26,65,66,25,68,17,48,39,5,17,14,14,44,58,69,31,62,18,64,37,1,49,40,44,2,60,69,11,60,57,26],[28,27,69,58,56,53,35,61,9,22,60,31,31,20,39,7,52,24,55,67,21,14,37,26,46,68,4,44,55,32,52,20,58,11,56,43,64,25,31,11,25,44,62,48,50,54,63,41,34,23,41,27],[23,27,65,11,2,20,1,64,42,51,59,10,66,19,22,21,68,67,69,17,19,51,12,38,45,20,22,63,38,30,53,13,38,65,21,16,5,35,23,6,9,63,68,46,67,33,23,13,21,47,28,64],[24,49,41,35,54,64,25,42,3,64,17,63,13,33,69,34,9,29,50,5,48,46,70,29,45,36,29,47,38,30,1,25,33,35,46,47,43,3,23,21,68,30,31,28,37,46,54,10,7,29,60,3],[57,56,2,21,20,31,47,16,65,66,7,3,19,45,15,12,56,33,2,57,17,41,28,25,43,65,28,66,66,39,24,34,68,61,64,65,67,53,3,45,56,41,26,12,37,62,29,12,36,30,4,11],[42,51,60,13,35,26,54,23,11,34,12,58,4,39,25,45,31,50,27,13,42,63,34,43,35,48,1,34,62,11,52,24,13,66,17,12,33,12,67,37,15,54,48,10,18,45,24,23,59,49,54,28],[54,13,4,54,33,54,5,16,27,61,33,30,9,25,37,68,56,13,20,37,51,39,68,65,4,53,42,19,9,19,65,52,67,60,19,23,67,2,55,26,10,51,62,5,64,51,33,51,63,67,38,8],[48,28,23,62,48,28,70,18,65,68,13,46,51,27,69,24,51,34,43,18,47,43,17,65,47,34,57,7,4,18,35,14,27,1,46,2,53,8,25,30,59,63,2,26,56,40,5,53,24,30,47,34],[16,44,54,19,3,35,30,57,54,45,35,1,55,44,60,18,26,35,2,68,67,21,68,25,4,10,35,69,19,67,44,34,7,52,30,10,8,46,13,40,3,51,11,24,39,50,56,23,18,35,10,11],[37,44,50,45,40,49,4,21,66,26,50,65,51,67,24,16,43,67,12,63,21,59,6,68,7,41,44,25,16,49,65,20,19,64,57,58,69,15,69,22,14,31,49,4,51,47,42,2,69,54,2,1],[28,52,55,17,65,47,41,31,65,26,13,39,9,59,60,3,51,43,59,49,4,70,9,37,25,26,46,27,5,49,61,64,51,33,8,8,50,64,53,61,32,1,44,30,29,32,64,28,36,17,47,49],[17,23,23,10,31,20,16,17,42,21,65,14,37,28,39,29,7,70,53,37,40,48,7,65,44,25,24,45,8,4,25,46,7,70,15,67,23,1,2,16,35,44,26,11,62,52,47,34,3,65,33,40],[36,66,7,1,57,56,61,24,18,3,6,69,66,15,68,16,36,41,52,15,47,39,5,31,14,46,44,36,59,49,39,59,55,3,25,9,8,70,3,58,41,26,12,58,20,9,70,9,2,69,15,34],[45,53,17,5,68,30,53,33,3,55,49,68,33,3,66,17,6,31,61,23,17,2,27,36,39,5,20,69,44,15,48,42,64,59,24,58,51,16,69,10,15,66,18,46,14,43,46,70,64,17,62,24],[63,2,16,66,11,13,37,70,28,34,38,30,32,52,42,67,57,51,11,1,18,61,14,28,22,22,37,53,50,12,70,53,58,36,49,15,64,26,1,7,59,68,15,22,56,16,58,23,65,42,28,21],[59,51,11,64,61,59,2,10,70,50,35,8,50,3,4,21,40,68,53,63,30,55,3,22,21,44,38,41,25,1,60,33,53,31,24,26,50,30,7,8,63,12,34,1,24,8,10,11,51,51,53,5],[57,42,43,21,15,19,49,60,51,53,11,26,64,67,12,22,21,57,5,41,2,51,59,16,35,33,56,36,12,67,58,69,10,1,59,68,62,27,46,45,3,59,1,38,35,32,26,35,68,12,41,40],[3,10,53,34,54,39,67,64,60,50,22,10,48,65,63,8,14,37,1,65,13,70,38,12,17,37,30,65,36,46,57,69,67,32,47,36,63,59,46,54,50,20,58,47,58,57,52,38,19,7,5,52],[62,60,30,63,33,49,8,8,14,50,66,70,41,62,4,46,69,18,27,12,65,51,2,25,32,55,70,17,1,35,5,2,51,10,18,8,44,8,27,65,51,35,32,55,70,10,6,36,22,37,16,43],[22,46,18,51,35,21,25,11,7,11,62,2,65,44,6,59,57,59,8,50,58,22,60,66,48,33,40,38,44,23,5,46,62,40,55,32,29,31,15,64,15,69,31,26,11,64,37,47,13,69,33,35],[44,18,19,10,19,24,8,34,64,57,65,67,2,68,14,19,64,13,60,56,52,22,54,19,39,36,69,51,57,50,21,55,16,36,61,28,20,52,63,19,20,37,28,41,11,22,40,8,62,53,58,48],[34,18,45,51,43,29,42,34,68,60,3,1,69,18,40,38,45,63,30,21,13,42,59,61,19,46,40,26,15,41,43,68,55,15,47,53,65,36,70,1,10,53,25,38,5,24,66,34,69,8,24,63],[70,19,65,41,9,46,47,37,62,19,23,38,5,6,9,61,55,67,7,34,12,52,62,19,32,14,36,31,57,63,18,15,58,6,34,62,64,23,14,36,47,68,66,60,22,7,40,22,4,14,22,63],[69,66,3,25,70,70,55,61,68,2,31,32,59,64,33,40,17,41,24,9,27,16,1,32,59,39,69,59,36,47,46,54,28,22,23,2,4,8,33,19,31,39,12,33,24,65,41,29,28,70,18,59],[68,24,15,70,1,68,66,35,8,38,44,3,53,61,19,13,34,33,6,40,19,64,28,14,70,58,37,5,43,31,19,29,7,66,8,48,34,25,8,51,44,23,57,60,30,12,35,40,13,56,4,53],[29,8,9,43,11,43,54,14,36,50,4,29,17,64,40,34,48,20,47,35,11,36,6,14,14,1,69,66,18,13,56,32,32,50,50,11,66,66,12,58,59,22,59,69,63,43,40,27,20,34,44,46],[20,2,30,54,19,51,1,22,33,23,46,70,26,12,67,39,33,67,64,53,46,55,26,61,46,38,43,17,62,52,42,68,19,5,30,9,32,22,56,47,37,13,46,22,69,49,57,25,15,20,57,59],[56,46,36,9,53,59,2,28,17,40,70,12,29,70,28,2,57,68,45,29,36,36,42,36,23,60,31,27,55,4,25,69,21,59,24,2,28,52,13,22,25,66,9,11,16,18,45,58,57,24,6,49],[34,60,59,21,28,28,24,45,27,19,4,59,29,25,6,39,70,26,33,64,1,52,13,66,32,69,62,56,23,69,49,29,21,21,8,2,66,57,40,21,2,22,22,51,1,66,12,23,37,10,12,36],[58,56,66,8,11,10,24,11,58,58,66,17,22,50,21,63,7,58,53,43,56,68,55,53,1,66,42,62,32,58,50,24,50,30,54,67,19,36,38,66,23,55,24,67,23,2,16,65,34,19,23,42],[19,4,27,48,61,29,57,35,57,28,64,53,20,21,57,34,26,18,59,18,20,15,59,15,35,5,39,63,25,46,11,56,16,17,20,11,17,43,60,18,60,58,40,41,66,55,51,2,41,44,4,33],[59,70,53,69,14,57,28,64,34,25,67,25,7,50,30,48,21,52,66,31,63,24,12,15,13,67,4,60,54,3,43,36,12,67,5,23,36,50,6,6,49,58,38,45,19,66,32,29,51,19,26,50],[14,25,52,50,29,41,53,52,53,15,19,1,58,6,47,17,65,58,2,1,65,56,48,59,55,28,42,65,25,49,37,60,62,70,54,38,61,31,38,16,16,30,57,7,65,66,53,56,17,8,14,33]]

mat3=[[65],[45],[45],[69],[55],[60],[29],[25],[16],[5],[62],[16],[29],[19],[34],[2],[24],[32],[66],[62],[60],[46],[42],[37],[51],[4],[41],[4],[66],[20],[9],[4],[66],[6],[56],[10],[51],[44],[7],[8],[5],[44],[28],[7],[10],[7],[24],[62],[19],[14],[45],[68],[9],[14],[51],[28],[8],[57],[59],[6],[54],[8],[19],[16],[63],[45],[33],[15],[33],[67]]

mat2 = [[1,2,3],[4,5,6],[7,8,9]]
re = Solution().minimizeTheDifference(mat3,800)
print(re)