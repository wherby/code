class Solution(object):
    def totalSteps(self, nums):
        """
        :type nums: List[int]
        :rtype: int
        """
        mx =0
        st =[]
        ml =0
        for a in nums:
            if a>= mx:
                mx =a 
                st=[]
            else:
                if len(st)==0:
                    st.append([mx,a])
                    ml = max(ml,1)
                else:
                    if  a < st[-1][-1]:
                        st.append([st[-1][-1],a])
                        ml = max(ml,1)
                    else:
                        s1 =st[-1]
                        while st and  a >= st[-1][0]:
                            st.pop()
                            s1 =st[-1]
                        s1.append(a)
                        ml = max(ml,len(s1)-1)
                        
            #print(st)
        return ml
                 
#re= Solution().totalSteps([1682,63,124,147,897,1210,1585,1744,1764,1945,323,984,1886,346,481,1059,1388,1483,1516,1842,1868,1877,504,1197,785,955,970,1848,1851,398,907,995,1167,1214,1423,1452,1464,1474,1311,1427,1757,1992,57,1625,1260,700,725])    
#re= Solution().totalSteps([10,6,5,10,15])
t2= [82,228,317,559,670,1535,1977,890,1243,1502,1720,1808,1819,1966,105,170,194,320,385,433,607,633,1144,1195,1365,1490,1778,921,1560,6,68,69,100,341,595,679,725,775,887,1316,296,613,658,682,777,1203,1350,1431,161,374,784,794,863,1080,1149,1509,1525,128,437,996,1045,1061,1102,1238,1624,1706,1961,808,950,1166,1531,1537,1732,866,1279,1494,1527,1595]
#re= Solution().totalSteps([7,11,1])
re = Solution().totalSteps(t2)
print(re)            