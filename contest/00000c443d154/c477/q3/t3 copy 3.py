from typing import List, Tuple, Optional

from collections import defaultdict,deque
from functools import cache
import heapq
from heapq import heappop,heappush 
from sortedcontainers import SortedDict,SortedList

from bisect import bisect_right,insort_left,bisect_left
from queue import Queue,LifoQueue,PriorityQueue
import math
INF  = math.inf


MOD = 10**9 + 7

def mod_pow(a, b, mod):
    result = 1
    while b:
        if b & 1:
            result = result * a % mod
        a = a * a % mod
        b >>= 1
    return result

class Solution:
    def sumAndMultiply(self, s: str, queries: List[List[int]]) -> List[int]:
        n = len(s)
        
        prefix_cnt = [0] * (n + 1)   
        prefix_sum = [0] * (n + 1)   
        prefix_val = [0] * (n + 1)   
        
        current_val = 0
        for i in range(n):
            digit = int(s[i])
            prefix_cnt[i+1] = prefix_cnt[i]
            prefix_sum[i+1] = prefix_sum[i]
            prefix_val[i+1] = prefix_val[i]
            
            if digit != 0:
                prefix_cnt[i+1] += 1
                prefix_sum[i+1] += digit
                current_val = (current_val * 10 + digit) % MOD
                prefix_val[i+1] = current_val
        
        results = []
        for l, r in queries:
            cnt_l = prefix_cnt[l]     
            cnt_r = prefix_cnt[r+1]   
            cnt_range = cnt_r - cnt_l 
            
            if cnt_range == 0:
                results.append(0)
                continue
            

            sum_range = prefix_sum[r+1] - prefix_sum[l]
            

            pow10 = mod_pow(10, cnt_range, MOD)
            

            val_l = prefix_val[l]
            val_r = prefix_val[r+1]
            
            x_mod = (val_r - val_l * pow10) % MOD
            if x_mod < 0:
                x_mod += MOD
            
            results.append(x_mod * sum_range % MOD)
        
        return results



# s = "9223538386222334255"
# queries =[[0,0],[0,2],[0,3],[0,4],[0,5],[0,8],[0,9],[0,10],[0,11],[0,13],[0,16],[0,18],[1,1],[1,2],[1,3],[1,5],[1,7],[1,8],[1,12],[1,14],[1,16],[1,18],[2,3],[2,6],[2,9],[2,15],[2,16],[2,18],[3,3],[3,4],[3,6],[3,7],[3,8],[3,10],[3,15],[3,17],[4,8],[4,9],[4,11],[4,14],[4,16],[5,9],[5,11],[5,12],[5,16],[5,17],[5,18],[6,8],[6,17],[6,18],[7,8],[7,9],[7,10],[7,13],[7,14],[7,15],[7,16],[8,17],[8,18],[9,13],[10,10],[10,11],[10,13],[10,14],[10,15],[10,18],[11,14],[11,15],[12,15],[12,17],[13,14],[13,16],[13,17],[14,15],[14,18],[15,18]]

# re =Solution().sumAndMultiply(s , queries )
# exc = [81,11986,147568,1936935,22136472,661214761,953377757,4544034,753104778,226561370,510569189,632582266,4,88,1561,335295,58119958,760030492,765694238,600219323,101387995,714458248,115,494298,894458668,847108532,192236680,799326477,9,280,67222,778426,10615140,344586749,82273396,565636729,1453626,17766738,992029007,737983531,971468410,1074808,122835904,305131541,662150133,732534292,435670884,15922,866922629,780604232,418,6562,73378,100417798,120044750,745336938,177816025,22634492,338013363,933345,4,88,20007,266796,3557344,225359098,22330,312676,28008,4435075,198,40104,568225,238,650845,68080]
# print(re)
# print(exc)
# print(re==exc)




s = "83653355979889175588"
queries =[[0,2],[0,8],[0,10],[0,11],[0,13],[0,14],[0,15],[0,19],[1,4],[1,5],[1,6],[1,12],[1,16],[1,17],[1,18],[2,4],[2,5],[2,7],[2,9],[2,10],[2,11],[2,14],[2,19],[3,5],[3,7],[3,9],[3,10],[3,14],[3,15],[3,16],[4,9],[4,10],[4,15],[4,16],[4,18],[4,19],[5,6],[5,12],[5,14],[6,7],[6,8],[6,9],[6,10],[6,14],[6,15],[6,19],[7,9],[7,11],[7,13],[7,15],[7,17],[7,18],[8,8],[8,10],[8,12],[8,13],[8,18],[9,9],[9,10],[9,11],[9,13],[9,14],[9,15],[9,16],[9,19],[10,10],[10,14],[10,15],[10,19],[11,12],[11,19],[12,13],[12,16],[13,16],[13,17],[13,19],[14,14],[15,16],[15,17],[18,18]]

re =Solution().sumAndMultiply(s , queries )
exc = [14212,317077000,161389787,882329907,274699767,300940897,785430555,513914994,62101,730660,9133375,827275582,751358554,229370145,746249343,9142,111061,17640585,809430657,974510677,13585136,660746179,40897448,5863,1120455,197417089,454375020,305251240,238173859,279317386,10739104,137595139,251006020,409388971,764290238,568372898,280,922291345,827127435,550,10621,145522,1959265,147732113,663243696,545670509,12537,2272324,328893895,673301512,319067560,101983139,81,24475,4017508,48994450,157682279,49,1264,19152,3275449,33553422,391456933,314015422,688127163,81,3461185,41534514,463935280,1408,461359328,1513,2675250,201850,2477385,394550284,1,900,12835,64]

print(re)
print(exc)
print(re==exc)