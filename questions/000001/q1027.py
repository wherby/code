# https://leetcode.cn/problems/longest-arithmetic-subsequence/
from typing import List, Tuple, Optional
from collections import Counter
from functools import lru_cache
from functools import cache

class Solution:
    def longestArithSeqLength(self, nums: List[int]) -> int:
        n = len(nums)

        mx = 1
        @cache 
        def dfs(k,d):
            for j in range(k+1,n):
                if nums[j] == nums[k] +d:
                    return dfs(j,d) +1
            return 0

        for i in range(n):
            for j in range(i+1,n):
                d = nums[j]-nums[i]
                re = dfs(i,d)+1
                mx = max(mx,re)
        return mx
ls = [453,29,64,39,200,96,118,1,311,447,434,461,452,453,469,417,446,62,167,460,278,209,307,51,141,230,12,136,213,184,59,394,209,498,469,295,477,266,44,81,167,245,403,186,203,477,357,259,271,306,346,241,428,347,33,134,266,456,402,115,251,156,255,22,347,343,292,164,493,350,194,262,403,484,284,144,384,145,352,394,369,330,168,104,267,267,423,204,483,337,241,416,66,200,148,291,138,63,38,366,84,87,79,261,204,64,426,353,190,105,188,492,266,23,271,260,376,433,397,127,328,292,405,336,158,43,393,41,121,417,111,479,72,426,261,49,462,186,49,83,32,54,143,203,0,392,465,109,300,270,403,105,433,482,71,227,210,435,176,105,494,277,477,81,264,197,386,441,24,201,98,170,164,122,127,78,330,256,164,436,27,152,251,115,113,219,151,374,248,102,21,429,330,121,438,278,334,70,389,405,158,273,261,336,220,460,110,248,299,273,3,31,487,383,181,196,172,393,295,103,289,448,152,386,59,15,309,233,51,127,18,124,74,465,104,355,343,50,388,107,407,49,288,129,67,124,251,367,102,71,15,314,13,336,13,393,125,80,480,321,322,297,488,237,10,275,365,166,131,183,216,329,321,97,28,358,61,45,233,462,106,94,293,197,195,470,269,48,28,309,382,460,498,235,27,284,171,225,274,418,428,375,105,90,284,467,234,5,254,116,40,406,211,441,59,58,18,65,280,87,347,35,200,153,435,171,291,350,365,403,163,342,368,246,321,401,38,413,445,20,381,288,323,387,171,456,319,428,493,4,322,410,74,213,57,318,50,19,373,155,336,171,3,246,32,51,130,115,246,407,90,296,68,88,190,153,239,44,71,220,232,159,368,44,349,345,471,301,408,161,59,199,490,319,491,275,381,239,188,184,332,453,274,181,131,348,10,419,94,73,102,440,486,113,281,381,176,12,383,438,81,345,187,489,434,244,107,176,117,55,445,358,438,191,132,207,447,28,411,219,37,333,481,348,87,53,9,309,293,105,310,500,457,267,312,223,290,76,94,154,0,446,20,42,264,341,40,65,257,428,176,361,136,407,44,129,415,498,394,324,68,24,131,104,186,56,203,227,336,192,39,488,306,454,126,251,91,417,141,264,480,374,126,183,400,171,352,470,169,329,410,299,58,82,431,296,298,483,173,74,224,59,191,256,331,311,314,56,359,298,345,369,170,286,191,296,462,424,343,103,151,371,450,315,28,307,132,104,393,489,22,461,274,214,471,160,87,147,377,366,295,323,63,34,303,395,346,320,395,383,4,334,219,50,214,196,469,428,38,362,9,183,70,362,413,97,238,340,368,276,413,343,342,103,389,346,377,353,51,221,102,94,462,106,340,237,473,307,222,243,19,87,244,339,485,308,466,496,26,427,359,450,157,369,149,9,320,454,442,111,260,158,412,166,235,121,455,428,417,479,256,430,292,97,391,391,241,231,439,485,24,253,484,280,176,24,263,256,203,93,394,49,378,200,19,77,341,66,266,78,345,43,172]
#re =Solution().longestArithSeqLength([3,6,9,12])
re =Solution().longestArithSeqLength(ls)
print(re)