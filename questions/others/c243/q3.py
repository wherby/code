# 
import heapq
class Solution(object):
    def assignTasks(self, servers, tasks):
        """
        :type servers: List[int]
        :type tasks: List[int]
        :rtype: List[int]
        """
        pq =[]
        taskq = []
        for i,s in enumerate(servers):
            heapq.heappush(pq,(s,i))
        
        n  = len(tasks)
        res = [-1] *n
        nextTime = 0
        for i in range(n):
            if not pq:
                t1,s1,idx1 = heapq.heappop(taskq)
                heapq.heappush(pq,(s1,idx1))
                nextTime = t1 
            nextTime = max(nextTime,i)
            while (taskq and taskq[0][0]<=nextTime) :
                t1,s1,idx1 = heapq.heappop(taskq)
                heapq.heappush(pq,(s1,idx1))
            s,idx = heapq.heappop(pq)
            res[i] = idx
            nextT = nextTime  +tasks[i]
            heapq.heappush(taskq,(nextT,s,idx))
        return res
servers =[511,7,949,819,755,715,761,117,32,400,509,184,381,798,141,759,771,727,368,259,641,968,18,904,650,922,397,840,758,570,331,791,470,958,628,53,120,786,863,215,759,434,589,80,526,675,807,333,365,293,125,49,739,984,936,936,360,179,95,118,225,529,756,56,858,6,440,101,436,431,227,700,102,165,191,400,230,831,660,566,695,330,996,419,916,650,672,144,393,182,676,276,974,915,194,782,229,659,995,449,368,911,459,122,170,4,94,332,278,739,558,819,351,415,790,771,397,545,475,45,838,309,251,956,747,806,974,998,761,641,754,311,911,692,605,177,369,251,166,124,833,848,773,846,982,790,54,642,258,603,243,174,935,372,444,959,120,802,724,811,284,951,29,671,716,3,713,632,738,567,679,851,441,815,627,410,5,474,435,941,346,41,465,984,326,710,777,778,886,41,161,534,152,138,752,892,673,142,975,262,228,577,377,867,690,396,803,522,232,468,976,975,77,702,633,443,180,894,271,360,675,145,983,308,561,405,390,972,597,578,11,153,897,761,451,679,335,54,558,940,852,765,316,371,73,134,866,640,378,331,565,688,332,817,517,455,179,19,441,394,228,872,247,658,430,786,575,911,467,80,175,542,696,369,84,433,557,824,945,346,701,601,750,162,973,959,349,756,308,48,853,678,75,330,174,619,466,979,501,663,64,750,300,484,663,269,996,986,839,227,126,704,366,64,37,401,40,776,257,775,666,863,731,217,937,86,183,284,526,287,796,683,261,352,801,890,951,976,770,752,569,614,189,770,163,707,563,894,680,965,204,566,149,758,59,588,756,610,531,554,772,403,563,276,981,569,514,375,417,843,241,177,980,361,886,828,184,673,166,468,406,861,268,595,166,585,443,786,575,673,988,413,735,942,863,375,745,167,639,620,871,378,328,971,124,173,880,626,841,71,407,832,752,314,551,205,218,954,378,383,167,387,786,868,796,808,824,782,756,492,603,823,421,983,356,946,363,104,101,638,857,753,749,109,993,991,956,705,516,134,642,606,339,622,890,366,372,453,88,796,295,796,865,485,543,869,73,440,200,435,625,833,956,255,68,549,905,581,620,151,768,7,580,353,360,296,552,307,911,343,483,6,531,126,896,852,519,121,517,871,315,353,196,457,786,310,617,507,995,510,633,752,445,333,477,371,684,721,133,394,561,247,355,960,201,713,128,645,612,181,244,417,928,424,791,539,653,197,155,332,801,995,154,618,994,494,568,866,487,879,635,168,968,979,184,348,23,380,136,366,917,558,263,635,233,642,605,129,702,230,134,654,690,942,961,414,203,460,665,860,655,943,9,111,26,970,192,733,434,181,645,469,439,73,729,238,608,421,249,109,869,541,606,526,855,793,177,512,640,960,690,913,316,911,58,68,354,156]
tasks =[360,199,713,169,449,688,449,453,221,917,568,59,593,429,146,35,666,800,668,281,166,527,684,377,531,713,449,376,921,238,234,55,990,762,512,434,928,289,524,410,115,80,474,280,956,603,488,449,437,638,256,919,226,80,568,579,61,323,337,411,517,776,650,93,825,243,80,32,232,844,446,828,506,84,217,552,833,379,437,544,688,785,689,38,416,822,260,696,531,247,66,250,187,919,533,847,14,391,386,912,827,955,59,345,114,211,42,349,292,482,840,834,76,869,489,920,318,535,570,124,285,647,580,612,94,280,858,304,577,244,110,754,545,267,815,443,860,45,232,444,156,849,988,116,422,945,495,834,600,370,573,151,71,791,805,294,1,962,493,680,122,629,33,649,81,118,117,311,524,347,957,360,302,711,856,696,464,484,414,635,473,149,795,624,315,13,603,531,212,49,54,286,908,341,927,303,685,698,188,797,909,144,580,683,452,143,308,160,415,191,26,99,792,821,154,535,598,37,395,250,247,634,648,869,661,708,669,750,694,865,457,789,860,875,789,828,54,73,718,689,658,94,417,16,771,730,3,699,57,854,955,349,844,150,288,634,554,852,750,363,306,708,467,706,857,640,251,388,488,299,760,497,359,131,127,664,1000,416,546,998,665,287,452,297,750,279,873,233,443,830,883,712,162,614,662,254,586,702,229,301,985,155,802,943,764,404,159,598,788,158,184,268,510,699,842,857,277,773,550,210,595,472,846,829,813,701,218,723,707,898,588,975,1000,271,524,533,388,269,223,650,747,426,760,639,997,250,982,31,715,267,224,943,587,977,674,246,124,456,229,928,8,476,586,379,946,486,488,997,900,548,191,768,659,246,575,801,23,809,51,721,269,775,309,858,689,377,75,697,683,408,31,635,915,146,243,138,955,700,299,548,502,354,688,326,550,596,152,368,833,517,481,426,802,28,573,279,94,767,165,306,703,134,490,269,302,321,614,989,348,549,661,356,913,503,302,503,14,729,801,341,531,716,412,942,519,646,480,362,130,712]
re = Solution().assignTasks(servers = [3,3,2], tasks = [1,2,3,2,1,2])
print(re)

